--====================================================
-- Titan Tivi Man Hub | Blox Fruits
-- Rayfield UI | Auto Farm REAL (Quest/Bay/Mob)
--====================================================

-- Load Rayfield
local Rayfield = loadstring(game:HttpGet("https://sirius.menu/rayfield"))()

-- Window
local Window = Rayfield:CreateWindow({
    Name = "ðŸ“º Titan Tivi Man Hub | Blox Fruits",
    LoadingTitle = "Titan Tivi Man Hub",
    LoadingSubtitle = "Auto Farm Rayfield",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "TitanTiviMan",
        FileName = "BloxFruits"
    }
})

-- Services
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RS = game:GetService("ReplicatedStorage")
local LP = Players.LocalPlayer
local Char = LP.Character or LP.CharacterAdded:Wait()
local HRP = Char:WaitForChild("HumanoidRootPart")
local Hum = Char:WaitForChild("Humanoid")

LP.CharacterAdded:Connect(function(c)
    Char = c
    HRP = c:WaitForChild("HumanoidRootPart")
    Hum = c:WaitForChild("Humanoid")
end)

-- State
local State = {
    Enable = false,
    Mode = "Quest",
    FlySpeed = 300,
    FastAttack = true
}

-- Tween
local function TweenTo(cf)
    local dist = (HRP.Position - cf.Position).Magnitude
    local t = dist / State.FlySpeed
    local tw = TweenService:Create(
        HRP,
        TweenInfo.new(t, Enum.EasingStyle.Linear),
        {CFrame = cf}
    )
    tw:Play()
    tw.Completed:Wait()
end

-- Equip weapon
local function EquipWeapon()
    local bp = LP.Backpack:GetChildren()
    for _,v in pairs(bp) do
        if v:IsA("Tool") then
            Hum:EquipTool(v)
            return
        end
    end
end

-- Click
local function Click()
    pcall(function()
        mouse1click()
    end)
end

-- Simple Quest Table (DEMO â€“ á»•n Ä‘á»‹nh, khÃ´ng Ä‘á»©ng im)
local QuestTable = {
    {
        Min = 1, Max = 700,
        Quest = "BanditQuest1",
        ID = 1,
        Mob = "Bandit",
        NPC = CFrame.new(1061,16,1547)
    },
    {
        Min = 700, Max = 1500,
        Quest = "Area1Quest",
        ID = 1,
        Mob = "Raider",
        NPC = CFrame.new(-424,73,1837)
    },
    {
        Min = 1500, Max = 2550,
        Quest = "HauntedQuest1",
        ID = 1,
        Mob = "Reborn Skeleton",
        NPC = CFrame.new(-9515,172,6071)
    }
}

-- Get Quest
local function GetQuestByLevel()
    local lv = LP.Data.Level.Value
    for _,q in pairs(QuestTable) do
        if lv >= q.Min and lv < q.Max then
            return q
        end
    end
end

-- Find Mob
local function FindMob(name)
    for _,m in pairs(workspace.Enemies:GetChildren()) do
        if m.Name == name and m:FindFirstChild("Humanoid")
        and m.Humanoid.Health > 0 then
            return m
        end
    end
end

-- Farm Mob
local function FarmMob(name)
    local mob = FindMob(name)
    if not mob then return end
    TweenTo(mob.HumanoidRootPart.CFrame * CFrame.new(0,0,4))
    EquipWeapon()
    repeat
        if State.FastAttack then Click() end
        task.wait()
    until mob.Humanoid.Health <= 0 or not State.Enable
end

-- Main Loop
task.spawn(function()
    while task.wait() do
        if not State.Enable then continue end

        local q = GetQuestByLevel()
        if not q then task.wait(2) continue end

        -- Take Quest
        TweenTo(q.NPC)
        task.wait(0.4)
        pcall(function()
            RS.Remotes.CommF_:InvokeServer("StartQuest", q.Quest, q.ID)
        end)

        -- Farm
        repeat
            FarmMob(q.Mob)
            task.wait(0.2)
        until not State.Enable
    end
end)

--================= RAYFIELD UI =================

local FarmTab = Window:CreateTab("âš›ï¸ Auto Farm")
local MiscTab = Window:CreateTab("ðŸ›  Misc")

FarmTab:CreateToggle({
    Name = "Enable Auto Farm",
    CurrentValue = false,
    Callback = function(v)
        State.Enable = v
    end
})

FarmTab:CreateDropdown({
    Name = "Farm Mode",
    Options = {"Quest","Mix"},
    CurrentOption = "Quest",
    Callback = function(v)
        State.Mode = v
    end
})

FarmTab:CreateSlider({
    Name = "Fly Speed",
    Range = {100,500},
    Increment = 10,
    CurrentValue = 300,
    Callback = function(v)
        State.FlySpeed = v
    end
})

FarmTab:CreateToggle({
    Name = "Fast Attack",
    CurrentValue = true,
    Callback = function(v)
        State.FastAttack = v
    end
})

MiscTab:CreateButton({
    Name = "Reset Character",
    Callback = function()
        Hum.Health = 0
    end
})

MiscTab:CreateParagraph({
    Title = "Titan Tivi Man Hub",
    Content = "Rayfield Only | Auto Farm Bay Quest\nðŸ’€ DÃ¡n lÃ  cháº¡y"
})
