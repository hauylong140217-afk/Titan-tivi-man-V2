--================ LOAD RAYFIELD =================
local Rayfield = loadstring(game:HttpGet("https://sirius.menu/rayfield"))()

local Window = Rayfield:CreateWindow({
    Name = "ðŸ“º Titan Tivi Man Hub | Blox Fruits",
    LoadingTitle = "Titan Tivi Man Hub",
    LoadingSubtitle = "Rayfield MAX",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "TitanTiviMan",
        FileName = "BloxFruits"
    },
    KeySystem = false
})

--================ SERVICES =================
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local VirtualUser = game:GetService("VirtualUser")
local LP = Players.LocalPlayer

--================ STATES =================
local State = {
    Farm = false,
    Aim = false,
    AutoAttack = false
}

--================ UTILS =================
local function Char()
    return LP.Character or LP.CharacterAdded:Wait()
end

local function HRP()
    return Char():WaitForChild("HumanoidRootPart")
end

--================ FIND NPC =================
local function GetNPC()
    local best, dist = nil, math.huge
    for _,v in pairs(workspace.Enemies:GetChildren()) do
        if v:FindFirstChild("Humanoid")
        and v.Humanoid.Health > 0
        and v:FindFirstChild("HumanoidRootPart") then
            local d = (v.HumanoidRootPart.Position - HRP().Position).Magnitude
            if d < dist then
                dist = d
                best = v
            end
        end
    end
    return best
end

--================ AIR LOCK FARM (NO SKILL) =================
local HEIGHT = 18
local DIST = 6

task.spawn(function()
    while task.wait(0.12) do
        if State.Farm then
            local npc = GetNPC()
            if npc then
                local nhrp = npc.HumanoidRootPart
                local hrp = HRP()

                -- KHÃ“A NHÃ‚N Váº¬T TRÃŠN KHÃ”NG
                hrp.AssemblyLinearVelocity = Vector3.zero
                hrp.CFrame =
                    nhrp.CFrame
                    * CFrame.new(0, HEIGHT, DIST)
                    * CFrame.Angles(math.rad(-90), 0, 0)

                -- Ã‰P NPC Äá»¨NG YÃŠN
                nhrp.AssemblyLinearVelocity = Vector3.zero
            end
        end
    end
end)

--================ AUTO CLICK (M1 ONLY) =================
task.spawn(function()
    while task.wait(0.05) do
        if State.AutoAttack then
            VirtualUser:Button1Down(Vector2.new(0,0))
            task.wait(0.01)
            VirtualUser:Button1Up(Vector2.new(0,0))
        end
    end
end)

--================ AIM (KHÃ”NG GIáº¬T) =================
RunService.RenderStepped:Connect(function()
    if State.Aim then
        local npc = GetNPC()
        if npc and npc:FindFirstChild("Head") then
            local cam = workspace.CurrentCamera
            cam.CFrame = CFrame.new(cam.CFrame.Position, npc.Head.Position)
        end
    end
end)

--================ RAYFIELD UI =================
local StartTab = Window:CreateTab("ðŸš€ Start", 4483362458)
local FarmTab  = Window:CreateTab("âš›ï¸ Auto Farm", 4483362458)
local AimTab   = Window:CreateTab("ðŸŽ¯ Aim", 4483362458)

StartTab:CreateButton({
    Name = "START MAX (NO SKILL)",
    Callback = function()
        State.Farm = true
        State.AutoAttack = true
        State.Aim = true
        Rayfield:Notify({
            Title = "Titan Tivi Man Hub",
            Content = "MAX CUá»I â€¢ ÄÃ¡nh M1 â€¢ TrÃªn khÃ´ng",
            Duration = 4
        })
    end
})

StartTab:CreateButton({
    Name = "STOP ALL",
    Callback = function()
        State.Farm = false
        State.AutoAttack = false
        State.Aim = false
    end
})

FarmTab:CreateToggle({
    Name = "Auto Farm (Air Lock)",
    CurrentValue = false,
    Callback = function(v)
        State.Farm = v
    end
})

FarmTab:CreateToggle({
    Name = "Auto Attack (M1)",
    CurrentValue = false,
    Callback = function(v)
        State.AutoAttack = v
    end
})

AimTab:CreateToggle({
    Name = "Aimbot NPC",
    CurrentValue = false,
    Callback = function(v)
        State.Aim = v
    end
})

Rayfield:Notify({
    Title = "Titan Tivi Man Hub",
    Content = "Loaded | MAX CUá»I NO SKILL",
    Duration = 3
})
